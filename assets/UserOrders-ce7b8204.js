import{_ as y,M as m,r as M,o as d,c as n,d as t,F as h,f as u,a as k,t as l,h as v}from"./index-1e1e5c69.js";import{p as f}from"./PaginationView-4cdee317.js";const{VITE_APP_URL:_,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ssozr",BASE_URL:"/vueweek77/",MODE:"production",DEV:!1,PROD:!0},D={data(){return{orders:[],delModal:"",delModalId:"",orderModal:"",orderModalId:"",orderData:"",pagination:{},page:""}},components:{pagination:f},methods:{getOrders(o=1){this.$http.get(`${_}/v2/api/${p}/admin/orders/?page=${o}`).then(s=>{this.orders=s.data.orders,this.pagination=s.data.pagination,console.log(this.pagination)}).catch(s=>{console.log(s)})},opDelModal(o){this.delModalId=o,this.delModal.show()},deleteOrder(){const o=this.delModalId;this.$http.delete(`${_}/v2/api/${p}/admin/order/${o}`).then(s=>{alert("刪除成功"),this.getOrders(),this.delModal.hide()}).catch(s=>{console.log(s),alert("刪除失敗")})},opOrderModal(o){this.orderModal.show(),this.orderData={...o},console.log(this.orderData)},upDataPaid(o){const s={is_paid:!o.is_paid};this.$http.put(`${_}/v2/api/${p}/admin/order/${o.id}`,{data:s}).then(r=>{console.log(r),alert("更新完成"),this.getOrders()}).catch(r=>{console.log(r)})},changePage(o){this.getOrders(o)},time(o){const s=new Date(o*1e3),r={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return s.toLocaleString("zh-TW",r)}},mounted(){this.getOrders(),this.delModal=new m(this.$refs.delModal),this.orderModal=new m(this.$refs.orderModal)}},P={class:"table"},C=t("thead",null,[t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1),O={class:"list-unstyled"},E={class:"form-check form-switch"},I=["checked","onClick"],w=["for"],V={key:0},x={key:1},A=["onClick"],T=["onClick"],$={class:"modal",tabindex:"-1",id:"delModal",ref:"delModal"},L={class:"modal-dialog"},B={class:"modal-content"},R=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"確認刪除?"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),U={class:"modal-body"},N={class:"modal-footer"},S=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),q={class:"modal",tabindex:"-1",id:"orderModal",ref:"orderModal"},z={class:"modal-dialog"},F={class:"modal-content"},H={class:"modal-header"},W={class:"modal-title"},j=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},J={key:0};function K(o,s,r,Q,a,i){const b=M("pagination");return d(),n(h,null,[t("table",P,[C,t("tbody",null,[(d(!0),n(h,null,u(a.orders,e=>(d(),n("tr",{key:e.id},[t("td",null,l(i.time(e.create_at)),1),t("td",null,l(e.user.email),1),t("td",null,[t("ul",O,[(d(!0),n(h,null,u(e.products,(c,g)=>(d(),n("li",{key:g},l(c.product.title)+"*"+l(c.qty)+"="+l(c.total),1))),128))])]),t("td",null,l(e.total),1),t("td",null,[t("div",E,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"item.id",checked:e.is_paid,onClick:c=>i.upDataPaid(e)},null,8,I),t("label",{class:"form-check-label",for:e.id},[e.is_paid?(d(),n("p",V,"已付款")):(d(),n("p",x,"未付款"))],8,w)])]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>i.opOrderModal(e)},"檢視",8,A),t("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>i.opDelModal(e.id)},"刪除",8,T)])]))),128))])]),k(b,{pages:a.pagination,onChangePage:i.changePage},null,8,["pages","onChangePage"]),t("div",$,[t("div",L,[t("div",B,[R,t("div",U,[t("p",null,"訂單編號:"+l(a.delModalId),1)]),t("div",N,[S,t("button",{type:"button",onClick:s[0]||(s[0]=e=>i.deleteOrder()),class:"btn btn-primary"},"確定刪除")])])])],512),t("div",q,[t("div",z,[t("div",F,[t("div",H,[t("h5",W,"訂單編號"+l(a.orderData.id),1),j]),t("div",G,[t("ul",null,[(d(!0),n(h,null,u(a.orderData.products,e=>(d(),n("li",{key:e.id},l(e.product.title)+" 數量:"+l(e.qty),1))),128))]),a.orderData?(d(),n("ul",J,[t("li",null,"訂單人姓名"+l(a.orderData.user.name),1),t("li",null,"信箱"+l(a.orderData.user.email),1),t("li",null,"電話"+l(a.orderData.user.tel),1),t("li",null,"備註"+l(a.orderData.user.address),1)])):v("",!0)])])])],512)],64)}const Z=y(D,[["render",K]]);export{Z as default};
